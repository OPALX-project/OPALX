Option, TFS=FALSE;
Option, ECHO=FALSE;
Option, PSDUMPFREQ=5;

// Option, PHASESCAN=TRUE;

Title,string="OPAL";

Edes=1.0;
gamma=(Edes+PMASS)/PMASS;
beta=sqrt(1-(1/gamma^2));
gambet=gamma*beta;
P0 = gamma*beta*PMASS;
brho = (PMASS*1.0e9*gambet) / CLIGHT;
value,{gamma,brho,Edes,beta,gambet};

// L:        physical element lenght (real)
// KS:       field scaling factor (real)
// FMAPFN:   field file name (string)
// ELEMEDGE: physical start of the element on the floor (real)
//

FINEG_MSL10: Solenoid, L=0.12, KS=0.31250, FMAPFN="FINEG-MSL10.T7", ELEMEDGE=-0.002;
FINEG_MSL20: Solenoid, L=0.12, KS=0.31250, FMAPFN="FINEG-MSL10.T7", ELEMEDGE=0.1;

l1:   Line = (FINEG_MSL10,FINEG_MSL20);

/*
 We can specity ONE distribution
*/

Dist1:DISTRIBUTION, DISTRIBUTION=gauss,
sigmax=  1.0e-03, sigmapx=1.0e-4, corrx=0.5,
sigmay=  2.0e-03, sigmapy=1.0e-4, corry=-0.5,
sigmat=  3.0e-03, sigmapt=1.0e-4, corrt=0.0;

/*
 We can specity ONE field solver object
*/

Fs1:FIELDSOLVER, FSTYPE=FFT, MX=16, MY=16, MT=128,
		 PARFFTX=true, PARFFTY=true, PARFFTT=false,
		 BCFFTX=open, BCFFTY=open, BCFFTT=open,
     BBOXINCR=1.0, GREENSF=INTEGRATED;


beam1: BEAM, PARTICLE=ELECTRON, pc=P0, NPART=5e4, BFREQ=1498.953425154e6, BCURRENT=0.032912, CHARGE=-1;

Select, Line=l1;

track,line=l1, beam=beam1, MAXSTEPS=200, DT=1.0e-12;
 run, method = "PARALLEL-T", beam=beam1, fieldsolver=Fs1, distribution=Dist1;
endtrack;
Stop;
